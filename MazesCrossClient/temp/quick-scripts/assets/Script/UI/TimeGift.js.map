{"version":3,"sources":["TimeGift.js"],"names":["passVal","timeVal","cc","Class","extends","Component","properties","giftView","default","type","Node","giftBtn","giftMask","giftTip","giftTimeText","Label","giftTime","visible","heartsNum","coinsNum","onLoad","window","timeGiftScript","SDK","getItem","time","parseInt","bind","node","on","EventType","TOUCH_END","event","openBtn","gameApplication","soundManager","playSound","active","showTimeGiftView","start","checkTime","console","log","heartVal","coinVal","string","openGiftView","bg","getChildByName","later","receive","lightBg0","lightBg1","receiveBtn","doubleBtn","runAction","repeatForever","rotateBy","off","resetTime","Heart","flyReward","mainScirpt","hearts","setItem","getComponent","toString","Coin","coins","refreashVal","onVideoBtnClick","isCompleted","timestamp","Date","parse","isStart","stopAllActions","shake","rotation","temp","tempMin","hor","count","Math","floor","min","sec","scheduleOnce"],"mappings":"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","file":"TimeGift.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\UI","sourcesContent":["// Learn cc.Class:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\r\nvar passVal = [3, 50];\r\nvar timeVal = [2, 100];\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        giftView: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        giftBtn: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        giftMask: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        giftTip: {\r\n            default: null,\r\n            type: cc.Node,\r\n        },\r\n        giftTimeText: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        giftTime: {\r\n            default: 0,\r\n            visible: false,\r\n        },\r\n        heartsNum: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n        coinsNum: {\r\n            default: null,\r\n            type: cc.Label,\r\n        },\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad() {\r\n        window.timeGiftScript = this;\r\n        SDK().getItem(\"giftTime\", function (time) {\r\n            time = parseInt(time);\r\n            this.giftTime = time;\r\n        }.bind(this));\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            this.openBtn();\r\n        }, this);\r\n    },\r\n\r\n    openBtn() {\r\n        window.gameApplication.soundManager.playSound(\"btn_click\");\r\n        if (this.giftTip.active) {\r\n            this.showTimeGiftView(1);\r\n        }\r\n    },\r\n\r\n    start() {\r\n        this.checkTime(true);\r\n    },\r\n\r\n    showTimeGiftView(type) {\r\n        console.log(type)\r\n        let heartVal = 0;\r\n        let coinVal = 0;\r\n        if (type == 1) {\r\n            heartVal = timeVal[0];\r\n            coinVal = timeVal[1];\r\n        } else if (type == 2) {\r\n            heartVal = passVal[0];\r\n            coinVal = passVal[1];\r\n        }\r\n        this.heartsNum.string = \"+\" + heartVal;\r\n        this.coinsNum.string = \"+\" + coinVal;\r\n        window.gameApplication.openGiftView(true);\r\n        var bg = this.giftView.getChildByName(\"Bg\");\r\n        var later = bg.getChildByName(\"Later\");\r\n        var receive = bg.getChildByName(\"ReceiveView\");\r\n        var lightBg0 = receive.getChildByName(\"Light0\");\r\n        var lightBg1 = receive.getChildByName(\"Light1\");\r\n        var receiveBtn = receive.getChildByName(\"Receive\");\r\n        var doubleBtn = receive.getChildByName(\"Double\");\r\n        lightBg0.runAction(\r\n            cc.repeatForever(\r\n                cc.repeatForever(cc.rotateBy(1, 120))\r\n            )\r\n        );\r\n        lightBg1.runAction(\r\n            cc.repeatForever(cc.rotateBy(1, 120))\r\n        );\r\n        receiveBtn.off(cc.Node.EventType.TOUCH_END);\r\n        //接收按钮\r\n        receiveBtn.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            window.gameApplication.soundManager.playSound(\"btn_click\");\r\n            \r\n            if (type == 1) {\r\n                //重置时间\r\n                this.resetTime();\r\n            }\r\n\r\n            //加体力\r\n            SDK().getItem(\"hearts\", function (Heart) {\r\n                Heart = parseInt(Heart);\r\n                Heart = Heart + heartVal;\r\n                window.gameApplication.flyReward(heartVal, \"heartSprite\", window.mainScirpt.hearts, null);\r\n                SDK().setItem({ hearts: Heart }, null);\r\n                if (null != window.mainScirpt.hearts) {\r\n                    window.mainScirpt.hearts.getComponent(cc.Label).string = Heart.toString();\r\n                }\r\n            }.bind(this));\r\n\r\n            //加金币\r\n            SDK().getItem(\"coins\", function (Coin) {\r\n                Coin = parseInt(Coin);\r\n                Coin = Coin + coinVal;\r\n                window.gameApplication.flyReward(coinVal * 0.1, \"coin\", window.mainScirpt.coins, null);\r\n                SDK().setItem({ coins: Coin }, function () {\r\n                    window.mainScirpt.refreashVal();\r\n                });\r\n                if (null != window.mainScirpt.coins) {\r\n                    window.mainScirpt.coins.getComponent(cc.Label).string = Coin.toString();\r\n                }\r\n            }.bind(this));\r\n\r\n            window.gameApplication.openGiftView(false);\r\n        }, this);\r\n\r\n        doubleBtn.off(cc.Node.EventType.TOUCH_END);\r\n        //三倍按钮\r\n        doubleBtn.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            window.gameApplication.soundManager.playSound(\"btn_click\");\r\n            window.gameApplication.onVideoBtnClick(function (isCompleted) {\r\n                if (isCompleted) {\r\n                    if (type == 1) {\r\n                        //重置时间\r\n                        this.resetTime();\r\n                    }\r\n\r\n                    //加体力\r\n                    SDK().getItem(\"hearts\", function (Heart) {\r\n                        Heart = parseInt(Heart);\r\n                        Heart = Heart + (heartVal * 3);\r\n                        window.gameApplication.flyReward((heartVal * 3), \"heartSprite\", window.mainScirpt.hearts, null);\r\n                        SDK().setItem({ hearts: Heart }, null);\r\n                        if (null != window.mainScirpt.hearts) {\r\n                            window.mainScirpt.hearts.getComponent(cc.Label).string = Heart.toString();\r\n                        }\r\n                    }.bind(this));\r\n\r\n                    //加金币\r\n                    SDK().getItem(\"coins\", function (Coin) {\r\n                        Coin = parseInt(Coin);\r\n                        Coin = Coin + (coinVal * 3);\r\n                        window.gameApplication.flyReward((coinVal * 0.3), \"coin\", window.mainScirpt.coins, null);\r\n                        SDK().setItem({ coins: Coin }, function () {\r\n                            window.mainScirpt.refreashVal();\r\n                        });\r\n                        if (null != window.mainScirpt.coins) {\r\n                            window.mainScirpt.coins.getComponent(cc.Label).string = Coin.toString();\r\n                        }\r\n                    }.bind(this));\r\n                    window.gameApplication.openGiftView(false);\r\n                }\r\n            }.bind(this));\r\n        }, this);\r\n\r\n        later.off(cc.Node.EventType.TOUCH_END);\r\n        later.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            window.gameApplication.soundManager.playSound(\"btn_click\");\r\n            window.gameApplication.openGiftView(false);\r\n        }, this);\r\n    },\r\n\r\n    resetTime() {\r\n        var timestamp = Date.parse(new Date());\r\n        timestamp = timestamp / 1000;\r\n        this.giftTime = timestamp;\r\n        SDK().setItem({ giftTime: this.giftTime }, null);\r\n    },\r\n\r\n    checkTime(isStart) {\r\n        var timestamp = Date.parse(new Date());\r\n        timestamp = timestamp / 1000;\r\n        if (timestamp - this.giftTime > 10800) {\r\n            if ((!this.giftTip.active && this.giftMask.active) || isStart) {\r\n                this.giftTip.active = true;\r\n                this.giftMask.active = false;\r\n                this.giftTimeText.node.active = true;\r\n                this.giftBtn.stopAllActions();\r\n                window.gameApplication.shake(this.giftBtn.getChildByName(\"Gift\"));\r\n            }\r\n        } else {\r\n            if ((this.giftTip.active && !this.giftMask.active) || isStart) {\r\n                this.giftTip.active = false;\r\n                this.giftTip.stopAllActions();\r\n                this.giftMask.active = true;\r\n                this.giftTimeText.node.active = true;\r\n                this.giftBtn.getChildByName(\"Gift\").stopAllActions();\r\n                this.giftBtn.getChildByName(\"Gift\").rotation = 0;\r\n            }\r\n            var temp = timestamp - this.giftTime;\r\n            temp = 10800 - temp;\r\n            var tempMin = temp / 60;\r\n            var hor = 0;\r\n            if (tempMin >= 60) {\r\n                var count = Math.floor(tempMin / 60);\r\n                hor = count;\r\n                tempMin = (tempMin % 60) * 60;\r\n            }\r\n            var min = tempMin / 60 < 10 ? \"0\" + Math.floor(tempMin / 60) : \"\" + Math.floor(tempMin / 60);\r\n            var sec = temp % 60 < 10 ? \"0\" + Math.floor(temp % 60) : \"\" + Math.floor(temp % 60);\r\n            if (temp <= 0) {\r\n                min = \"00\";\r\n                sec = \"00\"\r\n            }\r\n            if (hor > 0) {\r\n                this.giftTimeText.string = hor + \":\" + min + \":\" + sec;\r\n            } else {\r\n                this.giftTimeText.string = min + \":\" + sec;\r\n            }\r\n        }\r\n        this.scheduleOnce(function () {\r\n            this.checkTime(false);\r\n        }.bind(this), 1)\r\n    },\r\n\r\n    /* update(dt) {\r\n        \r\n    }, */\r\n});\r\n"]}