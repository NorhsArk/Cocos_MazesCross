{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\Script\\SDK/assets\\Script\\SDK\\facebook111.js"],"names":["Utils","require","SDK_AD","GAME_CHECK_URL","GAME_RECOMMEND_URL","GAME_STAT_URL","ELoadState","AD_LOADING","AD_LOAD_SUCCESS","AD_LOAD_FAIL","AD_COMPLETE","GM_PIDS","video_ad_ids","interstitial_ad_ids","game_id","MyPlayer","interstitialCount","videoOn","interstitialOn","interstitialOp","FB_SDK","cb","videoAd","videoAdState","InterstitialAd","InterstitialAdState","sdk_ad","prototype","getGameId","openVideoAd","openinterstitialAd","getInterstitialCount","isPlayOpAD","test","cc","random0To1","setUp","video_on","interstitial_on","interstitial_count","interstitial_op","console","log","sdkADNode","find","getComponent","reLoadOpAd","switchGameAsync","FBInstant","catch","e","self","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","code","data","rows","pic3","pic2","pic1","gid","setAd","open","setRequestHeader","send","init","initOP","i18n","loadVideoAd","loadInterstitialAd","name","player","getName","loader","load","getPhoto","err","texture","head","SpriteFrame","id","getID","locale","getLocale","SDK","isGM","playerID","inArray","clearData","setScore","all","my_help","bid","mid","lid","param","param1","param2","param3","canCreateShortcutAsync","then","canCreateShortcut","createShortcutAsync","share","score","context","chooseAsync","doShare","en_text","cn_text","framePath","loadRes","Texture2D","canvas","document","createElement","ctx","getContext","width","height","image","getHtmlElementObj","drawImage","base64Picture","toDataURL","updateAsync","action","cta","template","text","myReplayData","strategy","notification","getInterstitialAdAsync","interstitial","loadAsync","bind","stat","type","onOpAdBtnClicked","onPlayBtnClicked","getOpAdPic","picNum","showInterstitialAd","noOp","GetRandomNum","show","showAsync","getRewardedVideoAsync","rewardedVideo","hasVideoAd","showVideoAd","getItem","key","sys","localStorage","getDataAsync","setItem","p","setDataAsync","playWith","createAsync","getFriendsInfo","playerList","getConnectedPlayersAsync","players","i","length","headUrl","getSelfInfo","setRankScore","extra","rankName","contextID","getType","getLeaderboardAsync","leaderboard","setScoreAsync","error","getRankScore","getPlayerEntryAsync","info","entry","getPlayer","no","getRank","getScore","getPercent","getEntryCountAsync","count","num","offset","getEntriesAsync","entries","postRankToMessage","module","exports","instance"],"mappings":"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","file":"facebook111.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\Script\\SDK","sourcesContent":["var Utils = require(\"../Utils/Utils\");\r\nvar SDK_AD = require(\"./script/sdk_ad\");\r\nvar GAME_CHECK_URL = \"https://haiwai.31home.com:8003/games.detail\";\r\nvar GAME_RECOMMEND_URL = \"https://haiwai.31home.com:8003/games.recommend\";\r\nvar GAME_STAT_URL = \"https://haiwai.31home.com:8003/games.stat\";\r\n\r\nvar ELoadState = {\r\n    AD_LOADING          : \"AD_LOADING\",\r\n    AD_LOAD_SUCCESS     : \"AD_LOAD_SUCCESS\",\r\n    AD_LOAD_FAIL        : \"AD_LOAD_FAIL\",\r\n    AD_COMPLETE         : \"AD_COMPLETE\"\r\n};\r\n\r\nvar GM_PIDS = [1609486632505587, 1759127554126047];\r\nvar video_ad_ids = '160840521263423_160841467929995';\r\nvar interstitial_ad_ids = '160840521263423_160841827929959';\r\nvar game_id = \"160840521263423\";\r\nvar MyPlayer = {}\r\n\r\nvar interstitialCount = 2;\r\nvar videoOn = 1;\r\nvar interstitialOn = 1;\r\nvar interstitialOp = 0;\r\n\r\nvar FB_SDK = function() {\r\n    this.cb = null;\r\n    this.videoAd = null;\r\n    this.videoAdState = null;\r\n    this.InterstitialAd = null;\r\n    this.InterstitialAdState = null;\r\n\r\n    this.sdk_ad = null;\r\n};\r\n\r\n/**\r\n * 获得游戏ID\r\n**/\r\nFB_SDK.prototype.getGameId = function() {\r\n    return game_id;\r\n};\r\n\r\n/**\r\n * 是否打开视频广告\r\n**/\r\nFB_SDK.prototype.openVideoAd = function() {\r\n    return videoOn >= 1;\r\n};\r\n\r\n/**\r\n * 是否打开插屏广告\r\n**/\r\nFB_SDK.prototype.openinterstitialAd = function() {\r\n    return interstitialOn >= 1;\r\n};\r\n\r\n/**\r\n * 每玩多少局播放一次插屏广告\r\n**/\r\nFB_SDK.prototype.getInterstitialCount = function() {\r\n    // console.log(\"__interstitialCount\",interstitialCount)\r\n    return interstitialCount;\r\n};\r\n\r\n//是否显示互推广告（互相推荐自己的游戏）\r\nFB_SDK.prototype.isPlayOpAD = function() {\r\n    var test = cc.random0To1() * 10;\r\n    if (test <= interstitialOp) {\r\n        return true;\r\n    }else{\r\n        return false;\r\n    }\r\n};\r\n\r\n/**\r\n * 根据后台配置，设置属性\r\n**/\r\nFB_SDK.prototype.setUp = function(video_on,interstitial_on,interstitial_count,interstitial_op) {\r\n    console.log(\"setUp__interstitialCount\",interstitial_count)\r\n    console.log(\"interstitialCount\",interstitialCount)\r\n    interstitialCount = interstitial_count;\r\n    videoOn = video_on;\r\n    interstitialOn = interstitial_on;\r\n    interstitialOp = interstitial_op;\r\n\r\n    console.log(\"__________________interstitialCount:\",interstitialCount);\r\n    if(interstitialOn >= 1 && interstitialOp >= 1){\r\n        \r\n\r\n        //获取\r\n        var sdkADNode = cc.find(\"Canvas/sdk_ad\");\r\n        if(sdkADNode != null){\r\n            this.sdk_ad = sdkADNode.getComponent(SDK_AD);\r\n        }\r\n\r\n        //加载互推广告\r\n        this.reLoadOpAd();\r\n    }\r\n};\r\n\r\n/**\r\n * 切换到别的游戏（互推游戏）\r\n**/\r\nFB_SDK.prototype.switchGameAsync = function(game_id) {\r\n    if (typeof FBInstant === 'undefined') return false;\r\n    FBInstant.switchGameAsync(game_id).catch(function (e) {\r\n          // Handle game change failure\r\n    });\r\n};\r\n\r\n/**\r\n * 重新加载互推广告\r\n**/\r\nFB_SDK.prototype.reLoadOpAd = function() {\r\n    cc.log(\"reLoadOpAd:\")\r\n    if(this.sdk_ad != null && interstitialOn >= 1 && interstitialOp >= 1){\r\n        var self = this;\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState == 4 && (xhr.status == 200)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                console.log(\"______________response\",response);\r\n                var code = response.code;\r\n                if(code != 500){\r\n                    // cb(true,response);\r\n\r\n                    var data = response.data.rows[0];\r\n                    if(data != null){\r\n                        var pic3 = data.pic3;\r\n                        var pic2 = data.pic2;\r\n                        var pic1 = data.pic1;\r\n                        var gid = data.game_id;\r\n                        self.sdk_ad.setAd(pic3,pic2,pic1,gid);\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        xhr.open(\"GET\", GAME_RECOMMEND_URL + \"?game_id=\"+game_id +\"&amount=1\",true);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n        xhr.send(); \r\n\r\n        console.log(GAME_RECOMMEND_URL + \"?game_id=\"+game_id +\"&amount=1\")\r\n    }\r\n};\r\n\r\n/**\r\n    初始化\r\n    1）执行初始化服务器配置\r\n    2）加载视频广告、插屏广告\r\n    3）设置语言\r\n*/\r\nFB_SDK.prototype.init = function() {\r\n\r\n    this.initOP();\r\n    if (typeof FBInstant === 'undefined') {\r\n        const i18n = require('LanguageData');\r\n        // i18n.init('zh');\r\n        i18n.init('en');\r\n        return;\r\n    }\r\n    // console.log(\"playerID\",FBInstant.player.getID());\r\n\r\n    this.loadVideoAd();\r\n    this.loadInterstitialAd();\r\n\r\n    MyPlayer.name = FBInstant.player.getName();\r\n    cc.loader.load(FBInstant.player.getPhoto(), function (err, texture) {\r\n        MyPlayer.head = new cc.SpriteFrame(texture);\r\n    });\r\n    MyPlayer.id = FBInstant.player.getID();\r\n\r\n    var locale = FBInstant.getLocale(); // 'en_US'\r\n    // if(locale == 'zh_CN'){\r\n        const i18n = require('LanguageData');\r\n        i18n.init('en');\r\n    // }\r\n};\r\n\r\n/**\r\n * 初始化服务器对游戏的配置\r\n**/\r\nFB_SDK.prototype.initOP = function() {\r\n\r\n    //从服务器加载初始化数据\r\n        // cc.log(\"[gameCheck]\" + GAME_CHECK_URL);\r\n    var self = this;\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.readyState == 4 && (xhr.status == 200)) {\r\n            var response = JSON.parse(xhr.responseText);\r\n            console.log(\"response\",response);\r\n            var code = response.code;\r\n            if(code != 500){\r\n                // cb(true,response);\r\n\r\n                var data = response.data;\r\n\r\n                var interstitial_op = data.interstitial_op;     //每10局显示几次互推\r\n                var interstitial_count = data.interstitial_count;  //每多少局显示一次插屏广告\r\n                var video_on = data.video_on;    //是否显示视频广告\r\n                var interstitial_on = data.interstitial_on;   //是否显示插屏广告\r\n                self.setUp(video_on,interstitial_on,interstitial_count,interstitial_op);\r\n            }\r\n        }\r\n    };\r\n\r\n    xhr.open(\"GET\", GAME_CHECK_URL + \"?game_id=\"+SDK().getGameId(),true);\r\n    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n    xhr.send(); \r\n};\r\n\r\n/**\r\n * 是否GM（调试用）\r\n**/\r\nFB_SDK.prototype.isGM = function() {\r\n    if (typeof FBInstant === 'undefined') return false;\r\n\r\n    var playerID = FBInstant.player.getID();\r\n    // console.log(\"Utils.inArray(playerID,GM_PIDS):\",Utils.inArray(playerID,GM_PIDS))\r\n    return Utils.inArray(playerID,GM_PIDS);\r\n};\r\n\r\n/**\r\n * 清除当前玩家所有数据\r\n**/\r\nFB_SDK.prototype.clearData = function() {\r\n    if (typeof FBInstant === 'undefined') return false;\r\n\r\n    SDK().setScore({all:0},null);\r\n    SDK().setScore({my_help:0},null);\r\n    var bid = 1;\r\n    for(var mid = 1;mid <=6;mid++){\r\n        for(var lid = 1;lid <= 100;lid++){\r\n            var param = {};\r\n            param[bid+\"_\"+mid+\"_\"+lid] = 0;    \r\n            this.setScore(param,null);\r\n\r\n            var param1 = {};\r\n            param1[bid+\"_\"+mid+\"_\"+lid+\"_moves\"] = 0;\r\n            this.setScore(param1,null);\r\n        }\r\n\r\n        var param2 = {};\r\n        param2[bid+\"_\"+mid] = 0;    \r\n        this.setScore(param2,null);\r\n\r\n        var param3 = {};\r\n        param3[\"unlock_\"+bid+\"_\"+mid] = 0;\r\n        SDK().setScore(param3,null);\r\n    }\r\n};\r\n\r\n/**\r\n * 获得用户的国家地区语言\r\n**/\r\nFB_SDK.prototype.getLocale = function() {\r\n    if (typeof FBInstant === 'undefined') return;\r\n\r\n    return FBInstant.getLocale();\r\n};\r\n\r\n//创建桌面快捷方式\r\nFB_SDK.prototype.canCreateShortcutAsync = function(cb) {\r\n    if (typeof FBInstant === 'undefined') return;\r\n\r\n    FBInstant.canCreateShortcutAsync()\r\n      .then(function(canCreateShortcut) {\r\n        if (canCreateShortcut) {\r\n          FBInstant.createShortcutAsync()\r\n            .then(function() {\r\n              // Shortcut created\r\n                if(cb!=null){\r\n                    cb(true);    \r\n                }\r\n            })\r\n            .catch(function() {\r\n              // Shortcut not created\r\n                if(cb!=null){\r\n                    cb(false);    \r\n                }\r\n            });\r\n        }else{\r\n            if(cb!=null){\r\n                cb(false);    \r\n            }\r\n        }\r\n    });\r\n};\r\n\r\n/**\r\n * 分享\r\n**/\r\nFB_SDK.prototype.share = function(score,cb) {\r\n    if (typeof FBInstant === 'undefined'){\r\n        if(cb!=null){\r\n            cb(true);    \r\n        }\r\n        return;\r\n    } \r\n    var self = this;\r\n\r\n    FBInstant.context\r\n    .chooseAsync()\r\n    .then(function() {\r\n            console.log(\"FBInstant.context.getID():\",FBInstant.context.getID());\r\n            self.doShare(score);\r\n            if(cb!=null){\r\n                cb(true);    \r\n            }\r\n        }\r\n    ).catch(function(e) {\r\n        console.log(\"catch\",e);\r\n        if(e.code != null && e.code == \"SAME_CONTEXT\"){\r\n            //相同的用户或group，不能再次发消息\r\n            if(cb!=null){\r\n                cb(false);    \r\n            }\r\n        }\r\n    });\r\n};\r\n\r\nFB_SDK.prototype.doShare = function(score) {\r\n    var self = this;\r\n    var en_text = self.getName() + \" finish \"+score+\" missions,Can you beat me?\";\r\n    var cn_text = self.getName() + \"向你发起挑战！他已经到了 \"+score+\" 层！\";\r\n    // console.log(\"share:\"+en_text);\r\n\r\n    var framePath = \"texture2d/game_icon\";\r\n    // console.log(\"framePath:\",framePath)\r\n    cc.loader.loadRes(framePath, cc.Texture2D, function (err, texture) {\r\n        let canvas = document.createElement('canvas');\r\n        let ctx = canvas.getContext('2d');\r\n        canvas.width = 600;\r\n        canvas.height = 420;\r\n\r\n        let image = texture.getHtmlElementObj();\r\n        ctx.drawImage(image, 0, 0);\r\n\r\n        var base64Picture = canvas.toDataURL('image/png');\r\n\r\n        FBInstant.updateAsync({\r\n          action: 'CUSTOM',\r\n          cta: 'Play Game',\r\n          template:'join_fight',\r\n          image: base64Picture,\r\n          text: en_text,\r\n          data: { myReplayData: '...' },\r\n          strategy: 'IMMEDIATE',\r\n          notification: 'NO_PUSH',\r\n        }).then(function() {\r\n          //当消息发送后\r\n          // console.log(\"____当消息发送后\")\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * 加载插屏广告\r\n**/\r\nFB_SDK.prototype.loadInterstitialAd = function() {\r\n    if (typeof FBInstant === 'undefined') return;\r\n    if(!this.openinterstitialAd()){\r\n        return;\r\n    }\r\n\r\n    // console.log(\"loadInterstitialAd\")\r\n    FBInstant.getInterstitialAdAsync(\r\n        interstitial_ad_ids,\r\n    ).then(function(interstitial) {\r\n        // console.log(\"FBInstant.getInterstitialAdAsync:\",interstitial);\r\n        this.InterstitialAd = interstitial;\r\n        this.InterstitialAdState = ELoadState.AD_LOADING;\r\n        return this.InterstitialAd.loadAsync();\r\n    }.bind(this)).catch(function(e) {\r\n            // console.log(\"load.showInterstitialAd catch\");\r\n            // console.log(JSON.stringify(e));\r\n        }.bind(this))\r\n    .then(function(){\r\n        // console.log(\"FBInstant.getInterstitialAdAsync done:\");\r\n        this.InterstitialAdState = ELoadState.AD_LOAD_SUCCESS;\r\n    }.bind(this));\r\n};\r\n\r\n//统计显示、点击次数（统计自己的互推广告）\r\nFB_SDK.prototype.stat = function(type,gid) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.readyState == 4 && (xhr.status == 200)) {\r\n            var response = JSON.parse(xhr.responseText);\r\n            // console.log(\"______________response\",response);\r\n        }\r\n    };\r\n\r\n    xhr.open(\"GET\", GAME_STAT_URL + \"?game_id=\"+gid +\"&type=\"+type,true);\r\n    xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n    xhr.send(); \r\n};\r\n\r\nFB_SDK.prototype.onOpAdBtnClicked = function() {\r\n    if((this.sdk_ad != null)){\r\n        this.sdk_ad.onPlayBtnClicked();\r\n    }\r\n};\r\n\r\n\r\nFB_SDK.prototype.getOpAdPic = function(picNum) {\r\n    if(this.sdk_ad != null){\r\n        if(picNum == 1){\r\n            return this.sdk_ad.pic1;    \r\n        }else if(picNum == 2){\r\n            return this.sdk_ad.pic2;    \r\n        }else if(picNum == 3){\r\n            return this.sdk_ad.pic3;    \r\n        }\r\n        \r\n    }else{\r\n        return null;\r\n    }\r\n};\r\n\r\n/**\r\n * 每玩多少局播放一次插屏广告\r\n * noOp == true时代表不播放互推广告\r\n**/\r\nFB_SDK.prototype.showInterstitialAd = function(cb,noOp) {\r\n    if (typeof FBInstant === 'undefined'){\r\n        if(cb) {\r\n            cb(false);\r\n        }\r\n        return;\r\n    };\r\n\r\n    console.log(\"FB_SDK.prototype.showInterstitialAd\",this.InterstitialAd);\r\n    console.log(\"this.sdk_ad\",this.sdk_ad);\r\n    console.log(\"interstitialOn\",interstitialOn);\r\n\r\n    if(interstitialOn < 1){\r\n        return;\r\n    }\r\n\r\n    if((this.sdk_ad != null && interstitialOp >= 1 && Utils.GetRandomNum(1,10)<=interstitialOp && !noOp) || (this.InterstitialAd == null && this.sdk_ad != null && !noOp)){\r\n    // if(this.sdk_ad != null){\r\n        console.log(\"sdk_ad:\",this.sdk_ad)\r\n        this.sdk_ad.show();\r\n\r\n        this.stat(1,this.sdk_ad.game_id);\r\n        if (cb) {\r\n            cb(true);\r\n        }\r\n\r\n        // console.log(\"this.sdk_ad.show()\");\r\n    }else if(this.InterstitialAd != null){\r\n        // console.log(\"show Interstitial ad start\");\r\n        this.InterstitialAd.showAsync().then(function() {\r\n            // console.log(\"this.showInterstitialAd.showAsync\");\r\n            this.InterstitialAdState = ELoadState.AD_COMPLETE;\r\n            // this.game.paused = false;\r\n            // window.sounds.toggleMusic(false);\r\n            if (cb) {\r\n                cb(true);\r\n            }\r\n\r\n            // console.log(\"show showInterstitialAd success\");\r\n            this.loadInterstitialAd();\r\n        }.bind(this))\r\n        .catch(function(e) {\r\n            // console.log(\"this.showInterstitialAd catch\");\r\n            this.InterstitialAdState = ELoadState.AD_COMPLETE;\r\n            // this.game.paused = false;\r\n            // window.sounds.toggleMusic(false);\r\n            // console.log(JSON.stringify(e));\r\n            if (cb) {\r\n                cb(false);\r\n            }\r\n        }.bind(this));\r\n    }else{\r\n        // console.log(\"show showInterstitialAd ad Stop\");\r\n        if (cb) {\r\n            cb(false);\r\n        }\r\n        this.loadInterstitialAd();\r\n    }\r\n};\r\n\r\n/**\r\n * 加载视频广告\r\n**/\r\nFB_SDK.prototype.loadVideoAd = function() {\r\n    if (typeof FBInstant === 'undefined') return;\r\n\r\n    if(!this.openVideoAd()){\r\n        return;\r\n    }\r\n    // console.log(\"FB_SDK.prototype.loadVideoAd\");\r\n    FBInstant.getRewardedVideoAsync(\r\n        video_ad_ids,\r\n    ).then(function(rewardedVideo) {\r\n        this.videoAd = rewardedVideo;\r\n        this.videoAdState = ELoadState.AD_LOADING;\r\n        return this.videoAd.loadAsync();\r\n    }.bind(this)).then(function(){\r\n        this.videoAdState = ELoadState.AD_LOAD_SUCCESS;\r\n    }.bind(this));\r\n};\r\n\r\n/**\r\n * 是否有视频广告可以播放\r\n**/\r\nFB_SDK.prototype.hasVideoAd = function() {\r\n    if (typeof FBInstant === 'undefined'){\r\n        return false;\r\n    };\r\n\r\n    return this.videoAd != null;\r\n};\r\n\r\n/**\r\n * 播放视频广告\r\n**/\r\nFB_SDK.prototype.showVideoAd = function(cb) {\r\n    if (typeof FBInstant === 'undefined'){\r\n        if(cb){\r\n            cb(true);\r\n        }\r\n        return;\r\n    };\r\n\r\n    // console.log(\"FB_SDK.prototype.showVideoAd\",this.videoAd);\r\n\r\n    if(this.videoAd != null){\r\n        // console.log(\"show video ad start\");\r\n        this.videoAd.showAsync().then(function() {\r\n            // console.log(\"this.videoAd.showAsync\");\r\n            this.videoAdState = ELoadState.AD_COMPLETE;\r\n            // this.game.paused = false;\r\n            // window.sounds.toggleMusic(false);\r\n            if (cb) {\r\n                cb(true);\r\n            }\r\n\r\n            // console.log(\"show video ad success\");\r\n            this.loadVideoAd();\r\n        }.bind(this))\r\n        .catch(function(e) {\r\n            // console.log(\"this.videoAd catch\");\r\n            this.videoAdState = ELoadState.AD_COMPLETE;\r\n            // this.game.paused = false;\r\n            // window.sounds.toggleMusic(false);\r\n            // console.log(JSON.stringify(e));\r\n            if (cb) {\r\n                cb(false);\r\n            }\r\n            this.loadVideoAd();\r\n        }.bind(this));\r\n    }else{\r\n        // console.log(\"show video ad Stop\");\r\n        if (cb) {\r\n            cb(false);\r\n        }\r\n        this.loadVideoAd();\r\n    }\r\n};\r\n\r\n/**\r\n * 获得玩家昵称\r\n**/\r\nFB_SDK.prototype.getName = function() {\r\n    if (typeof FBInstant === 'undefined') return \"undefined\";\r\n    return FBInstant.player.getName();\r\n};\r\n\r\n/**\r\n * 获得用户属性（一般来说可以获得设置的分数，以及用户的其他属性）\r\n**/\r\nFB_SDK.prototype.getItem = function(key,cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        var score = JSON.parse(cc.sys.localStorage.getItem(key));\r\n        if (typeof score === 'undefined' || score == null) {\r\n            score = 0;\r\n        }\r\n        cb(score,key);\r\n    }else{\r\n        var score = 0;\r\n        FBInstant.player\r\n            .getDataAsync([''+key])\r\n            .then(function(data) {\r\n                //console.log('data is loaded',key,data[key]);\r\n                if (typeof data[key] === 'undefined') {\r\n                    score = 0;\r\n                    //console.log(key+\"+null\")\r\n                }else{\r\n                    score = data[key];\r\n                }\r\n                cb(score,key);\r\n        });    \r\n    }\r\n};\r\n\r\n/**\r\n * 设置属性，如记录分数、记录各类和用户相关的属性\r\n * param要传递一个对象进来，如{score:100}\r\n**/\r\nFB_SDK.prototype.setItem = function(param,cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        for(var p in param){//遍历json对象的每个key/value对,p为key\r\n            // cc.log(\"setScore:\"+ p + \"_\" + param[p]);\r\n            cc.sys.localStorage.setItem(p, param[p]);\r\n        }\r\n        // \r\n        if(cb != null){\r\n            cb();\r\n        }\r\n    }else{\r\n        FBInstant.player\r\n            .setDataAsync(param)\r\n        .then(function() {\r\n            if(cb != null){\r\n                cb();\r\n            }\r\n            // console.log('------------data is set',param);\r\n        });\r\n    }\r\n};\r\n\r\n//榜单内容----------\r\n\r\n//请好友玩\r\nFB_SDK.prototype.playWith = function (id, score, cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        if (cb != null) {\r\n            cb(true);\r\n        }\r\n        return;\r\n    }\r\n    var self = this;\r\n    FBInstant.context\r\n        .createAsync(id)\r\n        .then(function () {\r\n            // console.log(\"FBInstant.context.getID():\",FBInstant.context.getID());\r\n            self.doShare(score);\r\n            if(cb!=null){\r\n                cb(true);\r\n            }else{\r\n                cb(false);\r\n            }\r\n        }\r\n        )\r\n};\r\n\r\n\r\n//获取好友的信息\r\nFB_SDK.prototype.getFriendsInfo = function (cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"set rank fail\");\r\n        if (cb != null) {\r\n            cb({});\r\n        }\r\n    } else {\r\n        var playerList = [];\r\n        FBInstant.player.getConnectedPlayersAsync()\r\n            .then(function (players) {\r\n                for (var i = 0; i < players.length; i=i+1) {\r\n                    playerList[i] = {};\r\n                    playerList[i].id = players[i].getID();\r\n                    playerList[i].name = players[i].getName();\r\n                    playerList[i].headUrl = players[i].getPhoto();\r\n                }\r\n                if (cb != null) {\r\n                    cb(playerList);\r\n                }\r\n            });\r\n    }\r\n\r\n}\r\n\r\n\r\n//获取自身信息\r\nFB_SDK.prototype.getSelfInfo = function (cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"set rank fail\");\r\n        if (cb !== null) {\r\n            cb({});\r\n        }\r\n    } else {\r\n        if (cb != null) {\r\n            cb(MyPlayer);\r\n        }\r\n        return MyPlayer;\r\n    }\r\n}\r\n\r\n\r\n//保存分数\r\nFB_SDK.prototype.setRankScore = function (type, score, extra, cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"set rank fail\");\r\n    } else {\r\n        var rankName;\r\n        var contextID = FBInstant.context.getID();\r\n        if (contextID != null) {\r\n            contextID = \".\" + contextID;\r\n        }\r\n        if (type == 1) {\r\n            rankName = \"Friends\";\r\n            if (contextID == null) {\r\n                console.log(FBInstant.context.getType());\r\n                contextID = \"\";\r\n                return;\r\n            }\r\n        } else if (type == 2) {\r\n            rankName = \"World\";\r\n            contextID = \"\";\r\n        } else {\r\n            if (null != cb) {\r\n                cb(\"wrong type\")\r\n            }\r\n            console.log(\"wrong type\");\r\n            return;\r\n        }\r\n        FBInstant\r\n            .getLeaderboardAsync(rankName + contextID)\r\n            .then(leaderboard => {\r\n                console.log(leaderboard.getName());\r\n                return leaderboard.setScoreAsync(score, extra);\r\n            })\r\n            .then(() => console.log('Score saved'))\r\n            .catch(error => console.error(error));\r\n\r\n    }\r\n};\r\n\r\n//获取自身的排行榜\r\nFB_SDK.prototype.getRankScore = function (type, cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"get self rank fail\");\r\n    } else {\r\n        var rankName;\r\n        var contextID = FBInstant.context.getID();\r\n        if (contextID != null) {\r\n            contextID = \".\" + contextID;\r\n        }\r\n        if (type == 1) {\r\n            rankName = \"Friends\";\r\n            if (contextID == null) {\r\n                console.log(FBInstant.context.getType());\r\n                contextID = \"\";\r\n                return;\r\n            }\r\n        } else if (type == 2) {\r\n            rankName = \"World\";\r\n            contextID = \"\";\r\n        } else {\r\n            if (null != cb) {\r\n                cb(\"wrong type\")\r\n            }\r\n            console.log(\"wrong type\");\r\n            return;\r\n        }\r\n        FBInstant\r\n            .getLeaderboardAsync(rankName + contextID)\r\n            .then(leaderboard => leaderboard.getPlayerEntryAsync())\r\n            .then(entry => {\r\n                var info = {};\r\n                info.id = entry.getPlayer().getID();\r\n                info.no = entry.getRank();\r\n                info.name = entry.getPlayer().getName();\r\n                info.score = entry.getScore();\r\n                info.headUrl = entry.getPlayer().getPhoto();\r\n                cb(info);\r\n            }).catch(error => console.error(error));\r\n    }\r\n};\r\n\r\n//获取榜单百分比\r\nFB_SDK.prototype.getPercent = function (cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"get rank fail\");\r\n        if (cb != null) {\r\n            cb();\r\n        }\r\n    } else {\r\n        FBInstant.getLeaderboardAsync('World')\r\n            .then(function (leaderboard) {\r\n                return leaderboard.getEntryCountAsync();\r\n            })\r\n            .then(function (count) {\r\n                if (cb != null) {\r\n                    cb(count);\r\n                }\r\n            });\r\n    }\r\n}\r\n\r\n\r\n//获取榜单\r\nFB_SDK.prototype.getRank = function (type, num, offset, cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"get rank fail\");\r\n    } else {\r\n        var rankName;\r\n        var contextID = FBInstant.context.getID();\r\n        if (contextID != null) {\r\n            contextID = \".\" + contextID;\r\n        }\r\n        if (type == 1) {\r\n            rankName = \"Friends\";\r\n            if (contextID == null) {\r\n                console.log(FBInstant.context.getType());\r\n                contextID = \"\";\r\n                if (cb != null) {\r\n                    cb([]);\r\n                }\r\n                return;\r\n            }\r\n        } else if (type == 2) {\r\n            rankName = \"World\";\r\n            contextID = \"\";\r\n        } else {\r\n            if (null != cb) {\r\n                cb(\"wrong type\")\r\n            }\r\n            console.log(\"wrong type\");\r\n            return;\r\n        }\r\n        var playerList = [];\r\n        FBInstant\r\n            .getLeaderboardAsync(rankName + contextID)\r\n            .then(leaderboard => leaderboard.getEntriesAsync(num, offset))//第一个是获取数量，第二个是起始点\r\n            .then(entries => {\r\n                for (var i = 0; i < entries.length; i++) {\r\n                    playerList[i] = {};\r\n                    playerList[i].id = entries[i].getPlayer().getID();\r\n                    playerList[i].no = entries[i].getRank();\r\n                    playerList[i].name = entries[i].getPlayer().getName();\r\n                    playerList[i].score = entries[i].getScore();\r\n                    playerList[i].headUrl = entries[i].getPlayer().getPhoto();\r\n                    /* console.log(\r\n                        entries[i].getRank() + '. ' +\r\n                        entries[i].getPlayer().getName() + ': ' +\r\n                        entries[i].getScore()+ 'url ' +\r\n                        entries[i].getPlayer().getPhoto()\r\n                    ); */\r\n                }\r\n                if (cb != null) {\r\n                    cb(playerList);\r\n                }\r\n            }).catch(error => console.error(error));\r\n    }\r\n};\r\n\r\nFB_SDK.prototype.postRankToMessage = function (type, cb) {\r\n    if (typeof FBInstant === 'undefined') {\r\n        console.log(\"post rank fail\");\r\n    } else {\r\n        var rankName;\r\n        var contextID = FBInstant.context.getID();\r\n        if (contextID != null) {\r\n            contextID = \".\" + contextID;\r\n        }\r\n        if (type == 1) {\r\n            rankName = \"Friends\";\r\n            if (contextID == null) {\r\n                console.log(FBInstant.context.getType());\r\n                contextID = \"\";\r\n                return;\r\n            }\r\n        } else if (type == 2) {\r\n            rankName = \"World\";\r\n            contextID = \"\";\r\n        } else {\r\n            if (null != cb) {\r\n                cb(\"wrong type\")\r\n            }\r\n            console.log(\"wrong type\");\r\n            return;\r\n        }\r\n        FBInstant.updateAsync({\r\n            action: 'LEADERBOARD',\r\n            name: rankName + contextID\r\n        })\r\n            .then(() => console.log('Update Posted'))\r\n            .catch(error => console.error(error));\r\n    }\r\n}\r\n\r\n\r\nmodule.exports = (function() {\r\n    var instance;\r\n    return function() {\r\n        if (!instance) {\r\n            instance = new FB_SDK();\r\n        }\r\n        return instance;\r\n    }\r\n})();\r\n\r\n\r\n"]}